# 09. Taro + React + TypeScript é¡¹ç›®æ¶æ„è§„èŒƒ

## ğŸ—ï¸ ç°ä»£åŒ–è·¨ç«¯å¼€å‘æ¶æ„

æœ¬é¡¹ç›®é‡‡ç”¨**Taro 3.x + React 18 + TypeScript**çš„ç°ä»£åŒ–è·¨ç«¯å¼€å‘æ¡†æ¶ï¼Œæ”¯æŒå°ç¨‹åºã€H5ã€APPç­‰å¤šå¹³å°ä¸€ç å¤šç«¯ã€‚

```
YourProject/                      # ä¸»é¡¹ç›®ç›®å½• (Cursorå¼€å‘ç¯å¢ƒ)
â”œâ”€â”€ .cursor/                      # Cursoré…ç½®å’Œæ–‡æ¡£
â”‚   â”œâ”€â”€ rules/                    # é¡¹ç›®è§„åˆ™å’Œæ ‡å‡†
â”‚   â”œâ”€â”€ agents/                   # AIä»£ç†é…ç½®
â”‚   â””â”€â”€ docs/                     # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ src/                          # æºä»£ç ç›®å½• â­â­â­
â”‚   â”œâ”€â”€ app.tsx                   # åº”ç”¨å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ app.config.ts             # å…¨å±€é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ app.scss                  # å…¨å±€æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ pages/                    # é¡µé¢ç›®å½•
â”‚   â”‚   â”œâ”€â”€ index/                # é¦–é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ index.tsx         # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ index.config.ts   # é¡µé¢é…ç½®
â”‚   â”‚   â”‚   â””â”€â”€ index.scss        # é¡µé¢æ ·å¼
â”‚   â”‚   â”œâ”€â”€ login/                # ç™»å½•é¡µé¢
â”‚   â”‚   â””â”€â”€ profile/              # ä¸ªäººèµ„æ–™é¡µé¢
â”‚   â”œâ”€â”€ components/               # å…¬å…±ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ error-boundary/       # é”™è¯¯è¾¹ç•Œç»„ä»¶
â”‚   â”‚   â””â”€â”€ user-card/            # ç”¨æˆ·å¡ç‰‡ç»„ä»¶
â”‚   â”œâ”€â”€ utils/                    # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ auth.ts              # è®¤è¯å·¥å…·
â”‚   â”‚   â”œâ”€â”€ loading.ts           # åŠ è½½çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ request.ts           # ç½‘ç»œè¯·æ±‚å°è£…
â”‚   â”‚   â”œâ”€â”€ storage.ts           # æœ¬åœ°å­˜å‚¨å·¥å…·
â”‚   â”‚   â””â”€â”€ store.ts             # çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ hooks/                    # è‡ªå®šä¹‰Hooks
â”‚   â”‚   â”œâ”€â”€ use-auth.ts          # è®¤è¯ç›¸å…³Hook
â”‚   â”‚   â”œâ”€â”€ use-loading.ts       # åŠ è½½çŠ¶æ€Hook
â”‚   â”‚   â””â”€â”€ use-performance.ts   # æ€§èƒ½ç›‘æ§Hook
â”‚   â”œâ”€â”€ store/                    # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â””â”€â”€ global.ts            # å…¨å±€çŠ¶æ€(Zustand)
â”‚   â”œâ”€â”€ assets/                   # é™æ€èµ„æº
â”‚   â”‚   â”œâ”€â”€ images/              # å›¾ç‰‡èµ„æº
â”‚   â”‚   â””â”€â”€ icons/               # å›¾æ ‡èµ„æº
â”‚   â”œâ”€â”€ config/                   # é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ constants.ts         # å¸¸é‡å®šä¹‰
â”‚   â””â”€â”€ types/                    # TypeScriptç±»å‹å®šä¹‰
â”‚       â””â”€â”€ common.ts            # é€šç”¨ç±»å‹
â”œâ”€â”€ config/                       # æ„å»ºé…ç½®
â”‚   â”œâ”€â”€ index.js                 # åŸºç¡€é…ç½®
â”‚   â”œâ”€â”€ dev.js                   # å¼€å‘ç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ prod.js                  # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”œâ”€â”€ scripts/                      # è¾…åŠ©è„šæœ¬
â”‚   â”œâ”€â”€ create-page.js           # åˆ›å»ºé¡µé¢è„šæœ¬
â”‚   â””â”€â”€ init-new-project.js      # é¡¹ç›®åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ test/                         # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ package.json                  # é¡¹ç›®ä¾èµ–ç®¡ç†
â”œâ”€â”€ tsconfig.json                 # TypeScripté…ç½®
â”œâ”€â”€ global.d.ts                   # å…¨å±€ç±»å‹å®šä¹‰
â””â”€â”€ miniprogram/                  # ç¼–è¯‘è¾“å‡ºç›®å½•
    â”œâ”€â”€ app.js                    # ç¼–è¯‘åçš„åº”ç”¨å…¥å£
    â”œâ”€â”€ app.json                  # åº”ç”¨é…ç½®
    â”œâ”€â”€ app.wxss                  # å…¨å±€æ ·å¼
    â”œâ”€â”€ pages/                    # ç¼–è¯‘åçš„é¡µé¢
    â”œâ”€â”€ project.config.json       # å¾®ä¿¡å¼€å‘è€…å·¥å…·é…ç½®
    â””â”€â”€ sitemap.json              # æœç´¢é…ç½®
```

## ğŸ¯ æ ¸å¿ƒå¼€å‘åŸåˆ™

### âš ï¸ å…³é”®ï¼šæ‰€æœ‰å¼€å‘éƒ½åœ¨ src/ ç›®å½•ä¸‹

å½“å¼€å‘åŠŸèƒ½æ—¶ï¼Œ**å¿…é¡»**åœ¨ `src/` ç›®å½•ä¸‹æ“ä½œï¼š

âœ… **æ­£ç¡®çš„å¼€å‘è·¯å¾„**:
- é¡µé¢æ–‡ä»¶: `src/pages/example/index.tsx`
- ç»„ä»¶æ–‡ä»¶: `src/components/user-card/index.tsx`
- å·¥å…·å‡½æ•°: `src/utils/request.ts`
- ç±»å‹å®šä¹‰: `src/types/user.ts`
- é™æ€èµ„æº: `src/assets/images/logo.png`

âŒ **é”™è¯¯çš„å¼€å‘è·¯å¾„**:
- `miniprogram/pages/` - è¿™æ˜¯ç¼–è¯‘è¾“å‡ºç›®å½•ï¼Œä¸è¦ç›´æ¥ä¿®æ”¹
- `pages/` - ä¸è¦åœ¨æ ¹ç›®å½•åˆ›å»ºé¡µé¢
- `components/` - ä¸è¦åœ¨æ ¹ç›®å½•åˆ›å»ºç»„ä»¶

## ğŸ”§ æŠ€æœ¯æ ˆè¯¦è§£

### æ ¸å¿ƒæ¡†æ¶
- **Taro 3.6.21**: è·¨ç«¯å¼€å‘æ¡†æ¶ï¼Œæ”¯æŒReactè¯­æ³•
- **React 18.0.0**: ç°ä»£åŒ–çš„UIåº“ï¼Œä½¿ç”¨å‡½æ•°ç»„ä»¶å’ŒHooks
- **TypeScript 5.0.4**: ç±»å‹å®‰å…¨çš„JavaScriptè¶…é›†

### çŠ¶æ€ç®¡ç†
- **Zustand**: è½»é‡çº§çŠ¶æ€ç®¡ç†åº“ï¼Œæ›¿ä»£Redux
- **React Hooks**: ç»„ä»¶å†…éƒ¨çŠ¶æ€ç®¡ç†

### æ ·å¼å¤„ç†
- **SCSS**: CSSé¢„å¤„ç†å™¨ï¼Œæ”¯æŒå˜é‡ã€åµŒå¥—ã€æ··å…¥
- **PostCSS**: CSSåå¤„ç†å™¨ï¼Œè‡ªåŠ¨å¤„ç†æµè§ˆå™¨å…¼å®¹æ€§

### æ„å»ºå·¥å…·
- **Webpack 5**: æ¨¡å—æ‰“åŒ…å™¨
- **Babel**: JavaScriptç¼–è¯‘å™¨
- **ESLint + Prettier**: ä»£ç è§„èŒƒå’Œæ ¼å¼åŒ–

## ğŸš€ å¼€å‘å·¥å…·åˆ†å·¥

### Cursor (ä¸»ç›®å½•)
- **æºç å¼€å‘**: åœ¨ `src/` ç›®å½•ä¸‹ç¼–å†™ TypeScript + React ä»£ç 
- **æ„å»ºå‘½ä»¤**: è¿è¡Œ `pnpm run dev:weapp` ç¼–è¯‘åˆ° `miniprogram/`
- **ç‰ˆæœ¬æ§åˆ¶**: Gitæ“ä½œå’Œä»£ç ç®¡ç†
- **æ–‡æ¡£ç¼–å†™**: é¡¹ç›®æ–‡æ¡£å’Œæ³¨é‡Š

### å¾®ä¿¡å¼€å‘è€…å·¥å…· (miniprogramç›®å½•)
- **é¢„è§ˆè°ƒè¯•**: æ‰“å¼€ `miniprogram/` ç›®å½•è¿›è¡Œè°ƒè¯•
- **çœŸæœºæµ‹è¯•**: æ‰«ç åœ¨çœŸæœºä¸Šæµ‹è¯•
- **ä»£ç ä¸Šä¼ **: å‘å¸ƒåˆ°å¾®ä¿¡å¹³å°

## ğŸ“ å¼€å‘è§„èŒƒ

### é¡µé¢å¼€å‘
```tsx
// src/pages/example/index.tsx
import { useState, useEffect } from 'react'
import { View, Text, Button } from '@tarojs/components'
import Taro from '@tarojs/taro'
import { useGlobalStore } from '@/store/global'
import './index.scss'

export default function Example() {
  const [loading, setLoading] = useState(false)
  const { user } = useGlobalStore()

  useEffect(() => {
    // é¡µé¢åŠ è½½æ—¶æ‰§è¡Œ
    console.log('é¡µé¢åŠ è½½å®Œæˆ')
  }, [])

  const handleSubmit = async () => {
    setLoading(true)
    try {
      // å¤„ç†ä¸šåŠ¡é€»è¾‘
      await performAction()
      Taro.showToast({ title: 'æ“ä½œæˆåŠŸ' })
    } catch (error) {
      Taro.showToast({ title: 'æ“ä½œå¤±è´¥', icon: 'error' })
    } finally {
      setLoading(false)
    }
  }

  return (
    <View className="container">
      <Text>ç”¨æˆ·: {user?.name}</Text>
      <Button onClick={handleSubmit} loading={loading}>
        æäº¤
      </Button>
    </View>
  )
}
```

### ç»„ä»¶å¼€å‘
```tsx
// src/components/user-card/index.tsx
import { View, Text, Image } from '@tarojs/components'
import type { User } from '@/types/common'
import './index.scss'

interface UserCardProps {
  user: User
  onClick?: (user: User) => void
  showActions?: boolean
}

export default function UserCard({ user, onClick, showActions = true }: UserCardProps) {
  const handleCardClick = () => {
    onClick?.(user)
  }

  return (
    <View className="user-card" onClick={handleCardClick}>
      <Image src={user.avatar} className="avatar" />
      <View className="info">
        <Text className="name">{user.name}</Text>
        <Text className="desc">{user.description}</Text>
      </View>
      {showActions && (
        <View className="actions">
          <Button size="mini">å…³æ³¨</Button>
        </View>
      )}
    </View>
  )
}
```

### é¡µé¢é…ç½®
```typescript
// src/pages/example/index.config.ts
import { PageConfig } from '@tarojs/taro'

const config: PageConfig = {
  navigationBarTitleText: 'ç¤ºä¾‹é¡µé¢',
  navigationBarBackgroundColor: '#ffffff',
  navigationBarTextStyle: 'black',
  backgroundColor: '#f5f5f5',
  enablePullDownRefresh: true,
  onReachBottomDistance: 50
}

export default config
```

## ğŸ”„ ç¼–è¯‘æµç¨‹

### å¼€å‘æµç¨‹
1. **æºç ç¼–å†™**: åœ¨ `src/` ç›®å½•ä¸‹ç¼–å†™ TypeScript + React ä»£ç 
2. **å®æ—¶ç¼–è¯‘**: è¿è¡Œ `pnpm run dev:weapp` è‡ªåŠ¨ç¼–è¯‘åˆ° `miniprogram/`
3. **è°ƒè¯•é¢„è§ˆ**: å¾®ä¿¡å¼€å‘è€…å·¥å…·æ‰“å¼€ `miniprogram/` ç›®å½•è°ƒè¯•
4. **ç”Ÿäº§æ„å»º**: è¿è¡Œ `pnpm run build:weapp` æ„å»ºç”Ÿäº§ç‰ˆæœ¬

### æ„å»ºå‘½ä»¤
```bash
# å¼€å‘æ¨¡å¼ - å¾®ä¿¡å°ç¨‹åº
NODE_OPTIONS="--openssl-legacy-provider" pnpm run dev:weapp

# ç”Ÿäº§æ„å»º - å¾®ä¿¡å°ç¨‹åº
NODE_OPTIONS="--openssl-legacy-provider" pnpm run build:weapp

# å¼€å‘æ¨¡å¼ - H5
pnpm run dev:h5

# ç”Ÿäº§æ„å»º - H5
pnpm run build:h5
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### ä»£ç åˆ†å‰²
- ä½¿ç”¨ Taro çš„åˆ†åŒ…é…ç½®ï¼ŒæŒ‰åŠŸèƒ½æ¨¡å—åˆ†å‰²ä»£ç 
- è·¯ç”±æ‡’åŠ è½½ï¼Œå‡å°‘é¦–å±åŠ è½½æ—¶é—´

### çŠ¶æ€ç®¡ç†ä¼˜åŒ–
- ä½¿ç”¨ Zustand æ›¿ä»£ Reduxï¼Œå‡å°‘æ ·æ¿ä»£ç 
- åˆç†ä½¿ç”¨ React Hooksï¼Œé¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“

### å›¾ç‰‡ä¼˜åŒ–
- ä½¿ç”¨ WebP æ ¼å¼ï¼Œå‡å°‘å›¾ç‰‡ä½“ç§¯
- å®ç°å›¾ç‰‡æ‡’åŠ è½½ï¼Œæå‡é¡µé¢åŠ è½½é€Ÿåº¦

## ğŸ› ï¸ å¼€å‘å·¥å…·æ”¯æŒ

### VS Code / Cursor æ’ä»¶
- **Taro**: å®˜æ–¹Taroå¼€å‘æ’ä»¶
- **TypeScript**: ç±»å‹æ£€æŸ¥å’Œæ™ºèƒ½æç¤º
- **ES7+ React/Redux/React-Native**: Reactå¼€å‘æ”¯æŒ
- **SCSS**: SCSSè¯­æ³•æ”¯æŒ

### è°ƒè¯•å·¥å…·
- **React DevTools**: Reactç»„ä»¶è°ƒè¯•
- **å¾®ä¿¡å¼€å‘è€…å·¥å…·**: å°ç¨‹åºè°ƒè¯•å’Œé¢„è§ˆ
- **Chrome DevTools**: H5è°ƒè¯•

## ğŸ” å¿«é€Ÿæ£€æŸ¥æ¸…å•

å¼€å‘æ–°åŠŸèƒ½æ—¶ï¼Œç¡®ä¿ï¼š

1. âœ… æ–‡ä»¶åœ¨ `src/` ç›®å½•ä¸‹
2. âœ… ä½¿ç”¨ TypeScript è¯­æ³•
3. âœ… éµå¾ª React Hooks æ¨¡å¼
4. âœ… é¡µé¢å·²åœ¨ `src/app.config.ts` ä¸­æ³¨å†Œ
5. âœ… ç»„ä»¶æœ‰å¯¹åº”çš„ç±»å‹å®šä¹‰
6. âœ… æ ·å¼ä½¿ç”¨ SCSS è¯­æ³•
7. âœ… ç½‘ç»œè¯·æ±‚ä½¿ç”¨å°è£…çš„ request å·¥å…·
8. âœ… çŠ¶æ€ç®¡ç†ä½¿ç”¨ Zustand æˆ– React Hooks

## ğŸ’¡ æ¶æ„ä¼˜åŠ¿

### å¼€å‘ä½“éªŒ
- **ç±»å‹å®‰å…¨**: TypeScriptæä¾›å®Œæ•´çš„ç±»å‹æ£€æŸ¥
- **ç»„ä»¶åŒ–**: Reactç»„ä»¶åŒ–å¼€å‘æ¨¡å¼
- **çƒ­æ›´æ–°**: å¼€å‘æ—¶å®æ—¶ç¼–è¯‘å’Œé¢„è§ˆ
- **ä»£ç è§„èŒƒ**: ESLint + Prettierè‡ªåŠ¨æ ¼å¼åŒ–

### æ€§èƒ½è¡¨ç°
- **æ‰“åŒ…ä¼˜åŒ–**: Webpack 5 çš„ä»£ç åˆ†å‰²å’Œä¼˜åŒ–
- **è¿è¡Œæ—¶ä¼˜åŒ–**: React 18 çš„å¹¶å‘ç‰¹æ€§
- **ä½“ç§¯ä¼˜åŒ–**: Tree Shaking åˆ é™¤æœªä½¿ç”¨ä»£ç 

### å¯ç»´æŠ¤æ€§
- **æ¨¡å—åŒ–**: æ¸…æ™°çš„ç›®å½•ç»“æ„å’Œå…³æ³¨ç‚¹åˆ†ç¦»
- **å¯å¤ç”¨**: ç»„ä»¶å’Œå·¥å…·å‡½æ•°çš„é«˜åº¦å¤ç”¨
- **æ˜“æ‰©å±•**: æ”¯æŒå¤šç«¯å¼€å‘å’ŒåŠŸèƒ½æ‰©å±•

---

**â­ æ ¸å¿ƒè®°å¿†ï¼šè¿™æ˜¯ä¸€ä¸ª Taro + React + TypeScript é¡¹ç›®ï¼Œæ‰€æœ‰å¼€å‘éƒ½åœ¨ `src/` ç›®å½•ä¸‹ï¼Œ`miniprogram/` æ˜¯ç¼–è¯‘è¾“å‡ºç›®å½•**
