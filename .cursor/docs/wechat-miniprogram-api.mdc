---
description:
globs:
alwaysApply: false
---
---
type: MANUAL
name: wechat-miniprogram-api
source: https://developers.weixin.qq.com/miniprogram/dev/api/
---

## 网络 (Network)

### wx.request(Object object)
- **描述**：发起网络请求。
- **参数**：
  - `url`: (String) **必需**。请求的URL。
  - `data`: (Object/String/ArrayBuffer) **可选**。请求的参数。
  - `header`: (Object) **可选**。设置请求的header。
  - `method`: (String) **可选**。HTTP请求方法。默认为"GET"。
  - `dataType`: (String) **可选**。返回的数据格式。默认为"json"。
- **返回**：通过`success`回调返回响应数据。
- **示例**：
  ```javascript
  wx.request({
    url: 'https://example.com/api',
    method: 'GET',
    success(res) {
      console.log(res.data)
    }
  })
  ```

## 数据缓存 (Storage)

### wx.setStorageSync(String key, Object data)
- **描述**：将数据存储在本地缓存中指定的key中。
- **参数**：
  - `key`: (String) **必需**。本地缓存中的指定的key。
  - `data`: (Object) **必需**。需要存储的内容。
- **返回**：无。
- **示例**：
  ```javascript
  wx.setStorageSync('key', {data: 'value'})
  ```

### wx.getStorageSync(String key)
- **描述**：从本地缓存中同步获取指定key对应的内容。
- **参数**：
  - `key`: (String) **必需**。本地缓存中的指定的key。
- **返回**：返回指定的内容。
- **示例**：
  ```javascript
  const data = wx.getStorageSync('key')
  console.log(data)
  ```

## 界面 (UI)

### wx.showToast(Object object)
- **描述**：显示一个消息提示框。
- **参数**：
  - `title`: (String) **必需**。要显示的文本内容。
  - `icon`: (String) **可选**。图标类型。可以是"success"，"loading"，"error"，"none"。默认为"success"。
  - `duration`: (Number) **可选**。提示框停留时间，单位毫秒。默认为1500。
  - `mask`: (Boolean) **可选**。是否显示透明蒙层以防止触摸穿透。默认为false。
- **返回**：调用成功时返回一个`Promise`。
- **示例**：
  ```javascript
  wx.showToast({
    title: 'Success!',
    icon: 'success',
    duration: 2000
  })
  ```

## 设备 (Device)

### wx.getSystemInfoSync()
- **描述**：获取系统信息同步接口。
- **参数**：无。
- **返回**：返回系统信息对象。
- **示例**：
  ```javascript
  const res = wx.getSystemInfoSync()
  console.log(res.model)
  ```

## 开放接口 (Open Interface)

### wx.login(Object object)
- **描述**：调用接口获取登录凭证（code）。
- **参数**：
  - `timeout`: (Number) **可选**。超时时间，单位ms。
- **返回**：通过`success`回调返回登录凭证。
- **示例**：
  ```javascript
  wx.login({
    success(res) {
      console.log(res.code)
    }
  })
  ```

### wx.getUserProfile(Object object)
- **描述**：获取用户信息。需要用户主动触发才能发起。
- **参数**：
  - `desc`: (String) **必需**。声明获取用户个人信息后的用途。
- **返回**：通过`success`回调返回用户信息。
- **示例**：
  ```javascript
  wx.getUserProfile({
    desc: '用于完善会员资料',
    success(res) {
      console.log(res.userInfo)
    }
  })
  ```

### wx.requestPayment(Object object)
- **描述**：发起微信支付。
- **参数**：
  - `timeStamp`: (String) **必需**。时间戳。
  - `nonceStr`: (String) **必需**。随机字符串。
  - `package`: (String) **必需**。统一下单接口返回的prepay_id。
  - `signType`: (String) **必需**。签名算法。
  - `paySign`: (String) **必需**。签名。
- **示例**：
  ```javascript
  wx.requestPayment({
    timeStamp: '1414561699',
    nonceStr: '5K8264ILTKCH16CQ2502SI8ZNMTM67VS',
    package: 'prepay_id=wx201410272009395522657a690389285100',
    signType: 'MD5',
    paySign: 'C380BEC2BFD727A4B6845133519F3AD6',
    success(res) {
      console.log('支付成功')
    }
  })
  ```

## 位置 (Location)

### wx.getLocation(Object object)
- **描述**：获取当前的地理位置、速度。
- **参数**：
  - `type`: (String) **可选**。坐标类型。默认为'wgs84'。
  - `altitude`: (Boolean) **可选**。传入true会返回高度信息。
- **返回**：通过`success`回调返回位置信息。
- **示例**：
  ```javascript
  wx.getLocation({
    type: 'wgs84',
    success(res) {
      console.log('纬度：' + res.latitude)
      console.log('经度：' + res.longitude)
    }
  })
  ```

### wx.chooseLocation(Object object)
- **描述**：打开地图选择位置。
- **参数**：
  - `latitude`: (Number) **可选**。目标纬度。
  - `longitude`: (Number) **可选**。目标经度。
- **返回**：通过`success`回调返回选择的位置信息。
- **示例**：
  ```javascript
  wx.chooseLocation({
    success(res) {
      console.log('位置名称：' + res.name)
      console.log('详细地址：' + res.address)
    }
  })
  ```

## 媒体 (Media)

### wx.chooseImage(Object object)
- **描述**：从本地相册选择图片或使用相机拍照。
- **参数**：
  - `count`: (Number) **可选**。最多可以选择的图片张数。默认9。
  - `sizeType`: (Array) **可选**。原图还是压缩图。默认['original', 'compressed']。
  - `sourceType`: (Array) **可选**。图片来源。默认['album', 'camera']。
- **示例**：
  ```javascript
  wx.chooseImage({
    count: 1,
    sizeType: ['compressed'],
    sourceType: ['album', 'camera'],
    success(res) {
      const tempFilePaths = res.tempFilePaths
      console.log(tempFilePaths)
    }
  })
  ```

### wx.uploadFile(Object object)
- **描述**：将本地资源上传到服务器。
- **参数**：
  - `url`: (String) **必需**。开发者服务器地址。
  - `filePath`: (String) **必需**。要上传文件资源的路径。
  - `name`: (String) **必需**。文件对应的key。
  - `formData`: (Object) **可选**。HTTP请求中其他额外的form data。
- **示例**：
  ```javascript
  wx.uploadFile({
    url: 'https://example.com/upload',
    filePath: tempFilePaths[0],
    name: 'file',
    formData: {
      user: 'test'
    },
    success(res) {
      console.log(res.data)
    }
  })
  ```

## 扫一扫 (Scan)

### wx.scanCode(Object object)
- **描述**：调起客户端扫码界面进行扫码。
- **参数**：
  - `onlyFromCamera`: (Boolean) **可选**。是否只能从相机扫码。默认false。
  - `scanType`: (Array) **可选**。扫码类型。默认['barCode', 'qrCode']。
- **示例**：
  ```javascript
  wx.scanCode({
    success(res) {
      console.log('扫码结果：' + res.result)
      console.log('扫码类型：' + res.scanType)
    }
  })
  ```

## 分享 (Share)

### wx.showShareMenu(Object object)
- **描述**：显示当前页面的转发按钮。
- **参数**：
  - `withShareTicket`: (Boolean) **可选**。是否使用带shareTicket的转发。
  - `menus`: (Array) **可选**。需要显示的转发按钮名称列表。
- **示例**：
  ```javascript
  wx.showShareMenu({
    withShareTicket: true,
    menus: ['shareAppMessage', 'shareTimeline']
  })
  ```

## 转发 (Forward)

### onShareAppMessage(Object object)
- **描述**：监听用户点击页面内转发按钮或右上角菜单"转发"按钮的行为。
- **返回**：自定义转发内容。
- **示例**：
  ```javascript
  Page({
    onShareAppMessage() {
      return {
        title: '自定义转发标题',
        path: '/page/user?id=123',
        imageUrl: '/images/share.jpg'
      }
    }
  })
  ```


