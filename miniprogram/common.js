(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[1],[,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(4),o=n(9),a=n(13),i=n(10),c=n(11),u=n(6),s=n.n(u),l=function(){function e(){Object(i["a"])(this,e)}return Object(c["a"])(e,[{key:"get",value:function(e,t){try{var n=s.a.getStorageSync(e);return void 0!==n&&null!==n?n:null!==t&&void 0!==t?t:null}catch(e){return console.error("Storage get error:",e),null!==t&&void 0!==t?t:null}}},{key:"set",value:function(e,t){try{return s.a.setStorageSync(e,t),!0}catch(e){return console.error("Storage set error:",e),!1}}},{key:"remove",value:function(e){try{return s.a.removeStorageSync(e),!0}catch(e){return console.error("Storage remove error:",e),!1}}},{key:"clear",value:function(){try{return s.a.clearStorageSync(),!0}catch(e){return console.error("Storage clear error:",e),!1}}},{key:"getInfo",value:function(){try{return s.a.getStorageInfoSync()}catch(e){return console.error("Storage getInfo error:",e),{keys:[],currentSize:0,limitSize:0}}}},{key:"setWithExpiry",value:function(e,t,n){try{var r=Date.now(),o={value:t,expiry:r+n};return this.set(e,o)}catch(e){return console.error("Storage setWithExpiry error:",e),!1}}},{key:"getWithExpiry",value:function(e,t){try{var n=this.get(e);if(!n)return null!==t&&void 0!==t?t:null;var r=Date.now();return n.expiry&&r>n.expiry?(this.remove(e),null!==t&&void 0!==t?t:null):void 0!==n.value?n.value:null!==t&&void 0!==t?t:null}catch(e){return console.error("Storage getWithExpiry error:",e),null!==t&&void 0!==t?t:null}}},{key:"has",value:function(e){try{var t=s.a.getStorageSync(e);return void 0!==t&&null!==t}catch(e){return console.error("Storage has error:",e),!1}}},{key:"keys",value:function(){try{var e=this.getInfo();return e.keys}catch(e){return console.error("Storage keys error:",e),[]}}},{key:"size",value:function(){try{var e=this.getInfo();return e.currentSize}catch(e){return console.error("Storage size error:",e),0}}},{key:"setMultiple",value:function(e){var t=this;try{var n=!0;return Object.entries(e).forEach((function(e){var r=Object(a["a"])(e,2),o=r[0],i=r[1];t.set(o,i)||(n=!1)})),n}catch(e){return console.error("Storage setMultiple error:",e),!1}}},{key:"getMultiple",value:function(e){var t=this;try{var n={};return e.forEach((function(e){n[e]=t.get(e)})),n}catch(e){return console.error("Storage getMultiple error:",e),{}}}},{key:"removeMultiple",value:function(e){var t=this;try{var n=!0;return e.forEach((function(e){t.remove(e)||(n=!1)})),n}catch(e){return console.error("Storage removeMultiple error:",e),!1}}},{key:"cleanExpired",value:function(){var e=this;try{var t=this.keys(),n=0;return t.forEach((function(t){try{var r=e.get(t);r&&r.expiry&&Date.now()>r.expiry&&(e.remove(t),n++)}catch(e){}})),n}catch(e){return console.error("Storage cleanExpired error:",e),0}}},{key:"getAsync",value:function(){var e=Object(o["a"])(Object(r["a"])().m((function e(t,n){var o,a;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.p=0,e.n=1,s.a.getStorage({key:t});case 1:return o=e.v,e.a(2,void 0!==o.data&&null!==o.data?o.data:null!==n&&void 0!==n?n:null);case 2:return e.p=2,a=e.v,console.error("Storage getAsync error:",a),e.a(2,null!==n&&void 0!==n?n:null)}}),e,null,[[0,2]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"setAsync",value:function(){var e=Object(o["a"])(Object(r["a"])().m((function e(t,n){var o;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.p=0,e.n=1,s.a.setStorage({key:t,data:n});case 1:return e.a(2,!0);case 2:return e.p=2,o=e.v,console.error("Storage setAsync error:",o),e.a(2,!1)}}),e,null,[[0,2]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"removeAsync",value:function(){var e=Object(o["a"])(Object(r["a"])().m((function e(t){var n;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.p=0,e.n=1,s.a.removeStorage({key:t});case 1:return e.a(2,!0);case 2:return e.p=2,n=e.v,console.error("Storage removeAsync error:",n),e.a(2,!1)}}),e,null,[[0,2]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"clearAsync",value:function(){var e=Object(o["a"])(Object(r["a"])().m((function e(){var t;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.p=0,e.n=1,s.a.clearStorage();case 1:return e.a(2,!0);case 2:return e.p=2,t=e.v,console.error("Storage clearAsync error:",t),e.a(2,!1)}}),e,null,[[0,2]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"getInfoAsync",value:function(){var e=Object(o["a"])(Object(r["a"])().m((function e(){var t,n;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.p=0,e.n=1,s.a.getStorageInfo();case 1:return t=e.v,e.a(2,{keys:t.keys||[],currentSize:t.currentSize||0,limitSize:t.limitSize||0});case 2:return e.p=2,n=e.v,console.error("Storage getInfoAsync error:",n),e.a(2,{keys:[],currentSize:0,limitSize:0})}}),e,null,[[0,2]])})));function t(){return e.apply(this,arguments)}return t}()}])}(),h=new l;t["a"]=h},,,,function(e,t,n){"use strict";n.d(t,"g",(function(){return k["a"]})),n.d(t,"d",(function(){return S["a"]})),n.d(t,"e",(function(){return E["d"]})),n.d(t,"f",(function(){return E["e"]})),n.d(t,"a",(function(){return E["a"]})),n.d(t,"c",(function(){return E["c"]})),n.d(t,"b",(function(){return E["b"]}));var r=n(13),o=n(4),a=n(42),i=n(9),c=n(18),u=n(8),s=n(11),l=n(10),h=n(15),f=n(14),d=n(35),v=n(7),g=n(6),b=n.n(g),p=function(e){return e["TOKEN"]="token",e["USER_INFO"]="userInfo",e["OPENID"]="openid",e["THEME"]="theme",e["LANGUAGE"]="language",e["SETTINGS"]="settings",e}({}),O=n(24),y={200:"\u8bf7\u6c42\u6210\u529f",201:"\u521b\u5efa\u6210\u529f",400:"\u8bf7\u6c42\u53c2\u6570\u9519\u8bef",401:"\u672a\u6388\u6743\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55",403:"\u62d2\u7edd\u8bbf\u95ee",404:"\u8bf7\u6c42\u7684\u8d44\u6e90\u4e0d\u5b58\u5728",405:"\u8bf7\u6c42\u65b9\u6cd5\u4e0d\u5141\u8bb8",408:"\u8bf7\u6c42\u8d85\u65f6",500:"\u670d\u52a1\u5668\u5185\u90e8\u9519\u8bef",502:"\u7f51\u5173\u9519\u8bef",503:"\u670d\u52a1\u4e0d\u53ef\u7528",504:"\u7f51\u5173\u8d85\u65f6"},w={url:"",method:"GET",baseURL:O["a"],timeout:O["b"],retryCount:O["c"],retryDelay:O["d"].RETRY_DELAY,showLoading:!1,loadingText:"\u8bf7\u6c42\u4e2d...",autoHandleError:!0,header:{}},j=function(e){function t(e,n,r,o){var a;return Object(l["a"])(this,t),a=Object(h["a"])(this,t,[e]),Object(v["a"])(a,"code",void 0),Object(v["a"])(a,"statusCode",void 0),Object(v["a"])(a,"data",void 0),Object(v["a"])(a,"config",void 0),a.name="HttpRequestError",a.code=n,a.statusCode=n,a.data=r,a.config=o,a}return Object(f["a"])(t,e),Object(s["a"])(t)}(Object(d["a"])(Error)),m=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(l["a"])(this,e),Object(v["a"])(this,"config",void 0),Object(v["a"])(this,"interceptors",void 0),Object(v["a"])(this,"pendingRequests",void 0),this.config=Object(u["a"])(Object(u["a"])({},w),t),this.interceptors={request:[],response:[]},this.pendingRequests=new Map,this.init()}return Object(s["a"])(e,[{key:"init",value:function(){this.interceptors.request.push(this.defaultRequestInterceptor.bind(this)),this.interceptors.response.push(this.defaultResponseInterceptor.bind(this))}},{key:"defaultRequestInterceptor",value:function(e){var t=b.a.getStorageSync(p.TOKEN);return t&&(e.header=Object(u["a"])(Object(u["a"])({},e.header),{},{Authorization:"Bearer ".concat(t)})),e.header=Object(u["a"])({"Content-Type":"application/json"},e.header),e}},{key:"defaultResponseInterceptor",value:function(e){var t=e.statusCode,n=e.data;if(t>=200&&t<300){if(n&&"object"===Object(c["a"])(n)&&"code"in n){if(0===n.code||200===n.code)return n;var r=n.message||n.msg||"\u4e1a\u52a1\u5904\u7406\u5931\u8d25";throw new j(r,n.code,n,this.config)}return n}if(401===t)throw b.a.removeStorageSync(p.TOKEN),b.a.removeStorageSync(p.USER_INFO),b.a.reLaunch({url:O["e"].LOGIN}),new j("\u767b\u5f55\u5df2\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55",t,n);var o=y[t]||"\u8bf7\u6c42\u5931\u8d25(".concat(t,")");throw new j(o,t,n)}},{key:"generateRequestKey",value:function(e){var t=e.url,n=e.method,r=e.data;return"".concat(n,":").concat(t,":").concat(JSON.stringify(r||{}))}},{key:"addRequestInterceptor",value:function(e){this.interceptors.request.push(e)}},{key:"addResponseInterceptor",value:function(e){this.interceptors.response.push(e)}},{key:"request",value:function(){var e=Object(i["a"])(Object(o["a"])().m((function e(t){var n,r,i,c,s,l,h,f,d,v,g,p,O,y,w;return Object(o["a"])().w((function(e){while(1)switch(e.n){case 0:n=Object(u["a"])(Object(u["a"])({},this.config),t),n.url.startsWith("http")||(n.url=(n.baseURL||"")+n.url),r=Object(a["a"])(this.interceptors.request),e.p=1,r.s();case 2:if((i=r.n()).done){e.n=5;break}return c=i.value,e.n=3,c(n);case 3:n=e.v;case 4:e.n=2;break;case 5:e.n=7;break;case 6:e.p=6,O=e.v,r.e(O);case 7:return e.p=7,r.f(),e.f(7);case 8:if(s=this.generateRequestKey(n),!this.pendingRequests.has(s)){e.n=9;break}return e.a(2,this.pendingRequests.get(s));case 9:return n.showLoading&&b.a.showLoading({title:n.loadingText||"\u8bf7\u6c42\u4e2d...",mask:!0}),l=this.executeRequest(n),this.pendingRequests.set(s,l),e.p=10,e.n=11,l;case 11:h=e.v,f=h,d=Object(a["a"])(this.interceptors.response),e.p=12,d.s();case 13:if((v=d.n()).done){e.n=16;break}return g=v.value,e.n=14,g(f);case 14:f=e.v;case 15:e.n=13;break;case 16:e.n=18;break;case 17:e.p=17,y=e.v,d.e(y);case 18:return e.p=18,d.f(),e.f(18);case 19:return e.a(2,f);case 20:throw e.p=20,w=e.v,n.autoHandleError&&(w instanceof j?this.handleError(w,n):(p=new j("\u7f51\u7edc\u8bf7\u6c42\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5",void 0,void 0,n),this.handleError(p,n))),w;case 21:return e.p=21,this.pendingRequests.delete(s),n.showLoading&&b.a.hideLoading(),e.f(21);case 22:return e.a(2)}}),e,this,[[12,17,18,19],[10,20,21,22],[1,6,7,8]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"executeRequest",value:function(){var e=Object(i["a"])(Object(o["a"])().m((function e(t){var n,r,a,i=arguments;return Object(o["a"])().w((function(e){while(1)switch(e.n){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:0,e.p=1,e.n=2,b.a.request({url:t.url,method:t.method||"GET",data:t.data,header:t.header,timeout:t.timeout,dataType:"json",responseType:"text"});case 2:return r=e.v,e.a(2,r);case 3:if(e.p=3,a=e.v,!(n<(t.retryCount||0)&&this.shouldRetry(a))){e.n=5;break}return e.n=4,this.delay((t.retryDelay||1e3)*(n+1));case 4:return e.a(2,this.executeRequest(t,n+1));case 5:if(!(a instanceof Error)){e.n=6;break}throw new j(a.message,void 0,void 0,t);case 6:throw new j("\u7f51\u7edc\u8bf7\u6c42\u5931\u8d25",void 0,void 0,t);case 7:return e.a(2)}}),e,this,[[1,3]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"shouldRetry",value:function(e){return!e.statusCode||(e.statusCode>=500&&e.statusCode<600||408===e.statusCode)}},{key:"delay",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}},{key:"handleError",value:function(e,t){this.showErrorToast(e),this.reportError(e,t)}},{key:"showErrorToast",value:function(e){if(401!==e.statusCode){var t=e.message;404===e.statusCode?t="\u8bf7\u6c42\u7684\u8d44\u6e90\u4e0d\u5b58\u5728":500===e.statusCode?t="\u670d\u52a1\u5668\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5":503===e.statusCode&&(t="\u670d\u52a1\u6682\u65f6\u4e0d\u53ef\u7528"),b.a.showToast({title:t||"\u8bf7\u6c42\u5931\u8d25",icon:"error",duration:2e3})}}},{key:"reportError",value:function e(t,n){var r={message:t.message,statusCode:t.statusCode,code:t.code,url:n.url,method:n.method,data:n.data,timestamp:(new Date).toISOString(),userAgent:b.a.getSystemInfoSync().system};try{console.log("Error reported:",r)}catch(e){console.error("Failed to report error:",e)}}},{key:"get",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t&&Object.keys(t).length>0){var o=Object.entries(t).filter((function(e){var t=Object(r["a"])(e,2),n=(t[0],t[1]);return void 0!==n&&null!==n})).map((function(e){var t=Object(r["a"])(e,2),n=t[0],o=t[1];return"".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(String(o)))})).join("&");e=e+(e.includes("?")?"&":"?")+o}return this.request(Object(u["a"])({url:e,method:"GET"},n))}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request(Object(u["a"])({url:e,method:"POST",data:t},n))}},{key:"put",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request(Object(u["a"])({url:e,method:"PUT",data:t},n))}},{key:"delete",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request(Object(u["a"])({url:e,method:"DELETE",data:t},n))}},{key:"patch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request(Object(u["a"])({url:e,method:"PATCH",data:t},n))}},{key:"upload",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=Object(u["a"])(Object(u["a"])({},this.config),r);e.startsWith("http")||(e=(o.baseURL||"")+e);var a=b.a.getStorageSync(p.TOKEN),i=Object(u["a"])({},o.header);return a&&(i["Authorization"]="Bearer ".concat(a)),new Promise((function(r,a){o.showLoading&&b.a.showLoading({title:o.loadingText||"\u4e0a\u4f20\u4e2d...",mask:!0}),b.a.uploadFile({url:e,filePath:t,name:"file",formData:n,header:i,timeout:o.timeout,success:function(e){try{var t=JSON.parse(e.data);r(t)}catch(t){r(e.data)}},fail:function(e){var t=new j(e.errMsg||"\u4e0a\u4f20\u5931\u8d25",void 0,void 0,o);o.autoHandleError&&b.a.showToast({title:t.message,icon:"error",duration:2e3}),a(t)},complete:function(){o.showLoading&&b.a.hideLoading()}})}))}},{key:"download",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(u["a"])(Object(u["a"])({},this.config),t);e.startsWith("http")||(e=(n.baseURL||"")+e);var r=b.a.getStorageSync(p.TOKEN),o=Object(u["a"])({},n.header);return r&&(o["Authorization"]="Bearer ".concat(r)),new Promise((function(t,r){n.showLoading&&b.a.showLoading({title:n.loadingText||"\u4e0b\u8f7d\u4e2d...",mask:!0}),b.a.downloadFile({url:e,header:o,timeout:n.timeout,success:t,fail:function(e){var t=new j(e.errMsg||"\u4e0b\u8f7d\u5931\u8d25",void 0,void 0,n);n.autoHandleError&&b.a.showToast({title:t.message,icon:"error",duration:2e3}),r(t)},complete:function(){n.showLoading&&b.a.hideLoading()}})}))}},{key:"cancelAll",value:function(){this.pendingRequests.clear()}}])}(),k=(new m,n(12)),S=n(19),I=function(){function e(){Object(l["a"])(this,e),Object(v["a"])(this,"state",void 0),Object(v["a"])(this,"listeners",void 0),this.state={userInfo:null,hasLogin:!1,openid:null,systemInfo:null,globalData:{}},this.listeners=[],this.init()}return Object(s["a"])(e,[{key:"init",value:function(){this.restoreState()}},{key:"restoreState",value:function(){var e=k["a"].get(p.USER_INFO),t=k["a"].get(p.OPENID);e&&(this.state.userInfo=e,this.state.hasLogin=!0),t&&(this.state.openid=t)}},{key:"getState",value:function(){return Object(u["a"])({},this.state)}},{key:"setState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.persist,r=void 0!==n&&n,o=t.silent,a=void 0!==o&&o,i=Object(u["a"])({},this.state);this.state=Object(u["a"])(Object(u["a"])({},this.state),e),r&&this.persistState(e),a||this.notifyListeners(this.state,i)}},{key:"persistState",value:function(e){void 0!==e.userInfo&&(e.userInfo?k["a"].set(p.USER_INFO,e.userInfo):k["a"].remove(p.USER_INFO)),void 0!==e.openid&&(e.openid?k["a"].set(p.OPENID,e.openid):k["a"].remove(p.OPENID))}},{key:"subscribe",value:function(e){var t=this;if("function"!==typeof e)throw new Error("Listener must be a function");return this.listeners.push(e),function(){var n=t.listeners.indexOf(e);n>-1&&t.listeners.splice(n,1)}}},{key:"notifyListeners",value:function(e,t){this.listeners.forEach((function(n){try{n(e,t)}catch(e){console.error("Store listener error:",e)}}))}},{key:"setUserInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setState({userInfo:e,hasLogin:!!e},Object(u["a"])({persist:!0},t))}},{key:"getUserInfo",value:function(){return this.state.userInfo}},{key:"setOpenid",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setState({openid:e},Object(u["a"])({persist:!0},t))}},{key:"getOpenid",value:function(){return this.state.openid}},{key:"setSystemInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setState({systemInfo:e},t)}},{key:"getSystemInfo",value:function(){return this.state.systemInfo}},{key:"setGlobalData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object(u["a"])({},this.state.globalData);r[e]=t,this.setState({globalData:r},n)}},{key:"getGlobalData",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null!==(t=this.state.globalData[e])&&void 0!==t?t:n}},{key:"removeGlobalData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(u["a"])({},this.state.globalData);delete n[e],this.setState({globalData:n},t)}},{key:"setGlobalDataBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(u["a"])(Object(u["a"])({},this.state.globalData),e);this.setState({globalData:n},t)}},{key:"clearGlobalData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setState({globalData:{}},e)}},{key:"login",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={userInfo:e,hasLogin:!0};t&&(r.openid=t),this.setState(r,Object(u["a"])({persist:!0},n))}},{key:"logout",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setState({userInfo:null,hasLogin:!1,openid:null},Object(u["a"])({persist:!0},e)),k["a"].remove(p.USER_INFO),k["a"].remove(p.OPENID),k["a"].remove(p.TOKEN)}},{key:"isLogin",value:function(){return this.state.hasLogin&&!!this.state.userInfo}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={userInfo:null,hasLogin:!1,openid:null,systemInfo:null,globalData:{}};this.setState(t,e),k["a"].clear()}},{key:"get",value:function(e,t){var n;return null!==(n=this.state[e])&&void 0!==n?n:t}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object(v["a"])({},e,t);this.setState(r,n)}},{key:"getListenerCount",value:function(){return this.listeners.length}},{key:"clearListeners",value:function(){this.listeners.length=0}},{key:"hasStateChanged",value:function(e){for(var t in e)if(this.state[t]!==e[t])return!0;return!1}},{key:"getStateDiff",value:function(e){var t={};for(var n in e){var r=n;this.state[r]!==e[r]&&(t[r]=e[r])}return t}},{key:"select",value:function(e){return e(this.state)}},{key:"selectAndSubscribe",value:function(e,t){var n=e(this.state);return this.subscribe((function(r,o){var a=e(r),i=e(o);a!==i&&(t(a,n),n=a)}))}}])}(),E=(new I,n(17))},function(e,t,n){"use strict";n.d(t,"d",(function(){return f})),n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return v})),n.d(t,"a",(function(){return g})),n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return p}));var r=n(4),o=n(9),a=n(6),i=n.n(a),c=n(12),u=n(19),s=function(e){return{id:Date.now().toString(),nickname:e.nickName,avatar:e.avatarUrl,gender:e.gender,country:e.country,province:e.province,city:e.city,language:e.language,createTime:(new Date).toISOString(),updateTime:(new Date).toISOString()}},l=function(){var e=Object(o["a"])(Object(r["a"])().m((function e(){var t,n,o;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:if(e.p=0,t=c["a"].get("openid"),!t){e.n=1;break}return e.a(2,t);case 1:return console.log("Getting user openid from server..."),e.n=2,new Promise((function(e){return setTimeout(e,500)}));case 2:return n="openid_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),c["a"].set("openid",n),e.a(2,n);case 3:throw e.p=3,o=e.v,console.error("\u83b7\u53d6OpenID\u5931\u8d25:",o),new Error("\u83b7\u53d6\u7528\u6237\u6807\u8bc6\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5");case 4:return e.a(2)}}),e,null,[[0,3]])})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(o["a"])(Object(r["a"])().m((function e(){var t,n,o,a=arguments;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:"\u7528\u4e8e\u5b8c\u5584\u7528\u6237\u8d44\u6599",e.p=1,e.n=2,i.a.getUserProfile({desc:t});case 2:return n=e.v,e.a(2,n.userInfo);case 3:throw e.p=3,o=e.v,console.error("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25:",o),o;case 4:return e.a(2)}}),e,null,[[1,3]])})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=Object(o["a"])(Object(r["a"])().m((function e(){var t,n,o,a;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.p=0,u["a"].show("\u767b\u5f55\u4e2d..."),e.n=1,h("\u7528\u4e8e\u5b8c\u5584\u4f1a\u5458\u8d44\u6599");case 1:if(t=e.v,t){e.n=2;break}throw new Error("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25");case 2:return n=s(t),e.n=3,l();case 3:return o=e.v,c["a"].set("userInfo",n),u["a"].showSuccess("\u767b\u5f55\u6210\u529f"),e.a(2,{userInfo:n,openid:o});case 4:if(e.p=4,a=e.v,console.error("\u767b\u5f55\u5931\u8d25:",a),null===a||void 0===a||!a.errMsg||!a.errMsg.includes("fail auth deny")){e.n=5;break}throw u["a"].showWarning("\u53d6\u6d88\u767b\u5f55"),new Error("\u7528\u6237\u53d6\u6d88\u6388\u6743");case 5:throw u["a"].showError("\u767b\u5f55\u5931\u8d25"),a;case 6:return e.p=6,u["a"].hide(),e.f(6);case 7:return e.a(2)}}),e,null,[[0,4,6,7]])})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Object(o["a"])(Object(r["a"])().m((function e(){var t,n;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.p=0,u["a"].show("\u521d\u59cb\u5316\u4e2d..."),e.n=1,l();case 1:return t=e.v,u["a"].hide(),e.a(2,{openid:t});case 2:throw e.p=2,n=e.v,console.error("\u9759\u9ed8\u767b\u5f55\u5931\u8d25:",n),u["a"].showError("\u521d\u59cb\u5316\u5931\u8d25"),n;case 3:return e.a(2)}}),e,null,[[0,2]])})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(o["a"])(Object(r["a"])().m((function e(){var t,n;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.p=0,e.n=1,u["a"].confirm("\u786e\u5b9a\u8981\u9000\u51fa\u767b\u5f55\u5417\uff1f","\u63d0\u793a");case 1:if(t=e.v,t){e.n=2;break}return e.a(2);case 2:c["a"].remove("userInfo"),c["a"].remove("token"),c["a"].remove("openid"),u["a"].showSuccess("\u5df2\u9000\u51fa"),e.n=4;break;case 3:throw e.p=3,n=e.v,console.error("\u9000\u51fa\u767b\u5f55\u5931\u8d25:",n),u["a"].showError("\u9000\u51fa\u5931\u8d25"),n;case 4:return e.a(2)}}),e,null,[[0,3]])})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=c["a"].get("userInfo"),t=!!e;return t},b=function(){return c["a"].get("userInfo")},p=function(){return c["a"].get("openid")}},,function(e,t,n){"use strict";var r=n(4),o=n(9),a=n(8),i=n(10),c=n(11),u=n(7),s=n(6),l=n.n(s),h=function(){function e(){Object(i["a"])(this,e),Object(u["a"])(this,"loadingCount",0),Object(u["a"])(this,"loadingTimer",null)}return Object(c["a"])(e,[{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u52a0\u8f7d\u4e2d...",t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{this.loadingCount++,1===this.loadingCount&&l.a.showLoading({title:e,mask:t})}catch(e){console.error("Loading show error:",e)}}},{key:"showWithOptions",value:function(e){this.show(e.title,e.mask)}},{key:"hide",value:function(){try{this.loadingCount=Math.max(0,this.loadingCount-1),0===this.loadingCount&&l.a.hideLoading()}catch(e){console.error("Loading hide error:",e)}}},{key:"forceHide",value:function(){try{this.loadingCount=0,l.a.hideLoading()}catch(e){console.error("Loading forceHide error:",e)}}},{key:"showSuccess",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u64cd\u4f5c\u6210\u529f",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1500,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{l.a.showToast({title:e,icon:"success",duration:t,mask:n})}catch(e){console.error("Loading showSuccess error:",e)}}},{key:"showError",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u64cd\u4f5c\u5931\u8d25",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1500,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{l.a.showToast({title:e,icon:"error",duration:t,mask:n})}catch(e){console.error("Loading showError error:",e)}}},{key:"showWarning",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u8b66\u544a",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1500,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{l.a.showToast({title:e,icon:"error",duration:t,mask:n})}catch(e){console.error("Loading showWarning error:",e)}}},{key:"showInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1500,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{l.a.showToast({title:e,icon:"none",duration:t,mask:n})}catch(e){console.error("Loading showInfo error:",e)}}},{key:"showText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1500,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{l.a.showToast({title:e,icon:"none",duration:t,mask:n})}catch(e){console.error("Loading showText error:",e)}}},{key:"hideToast",value:function(){try{l.a.hideToast()}catch(e){console.error("Loading hideToast error:",e)}}},{key:"showModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u63d0\u793a",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(r){try{var o={title:e,content:t,showCancel:!0,cancelText:"\u53d6\u6d88",confirmText:"\u786e\u5b9a",confirmColor:"#3CC51F",cancelColor:"#000000"},i=Object(a["a"])(Object(a["a"])({},o),n);l.a.showModal(Object(a["a"])(Object(a["a"])({},i),{},{success:function(e){r(e.confirm)},fail:function(){r(!1)}}))}catch(e){console.error("Loading showModal error:",e),r(!1)}}))}},{key:"confirm",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\u786e\u8ba4",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.showModal(t,e,Object(a["a"])({showCancel:!0},n))}},{key:"alert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\u63d0\u793a",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.showModal(t,e,Object(a["a"])({showCancel:!1},n))}},{key:"showActionSheet",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(r){try{var o=Object(a["a"])({itemList:e,title:t,itemColor:"#000000"},n);l.a.showActionSheet(Object(a["a"])(Object(a["a"])({},o),{},{success:function(e){r({tapIndex:e.tapIndex,cancel:!1})},fail:function(){r({tapIndex:-1,cancel:!0})}}))}catch(e){console.error("Loading showActionSheet error:",e),r({tapIndex:-1,cancel:!0})}}))}},{key:"showWithTimeout",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u52a0\u8f7d\u4e2d...",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new Promise((function(o){e.show(t,r),e.loadingTimer=setTimeout((function(){e.hide(),o(!0)}),n)}))}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){this.loadingTimer&&(clearTimeout(this.loadingTimer),this.loadingTimer=null)}))},{key:"withLoading",value:function(){var e=Object(o["a"])(Object(r["a"])().m((function e(t){var n,o,a,i,c=arguments;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:"\u52a0\u8f7d\u4e2d...",o=!(c.length>2&&void 0!==c[2])||c[2],this.show(n,o),e.p=1,e.n=2,t();case 2:return a=e.v,e.a(2,a);case 3:throw e.p=3,i=e.v,i;case 4:return e.p=4,this.hide(),e.f(4);case 5:return e.a(2)}}),e,this,[[1,3,4,5]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"withLoadingAndToast",value:function(){var e=Object(o["a"])(Object(r["a"])().m((function e(t){var n,o,a,i,c,u,s=arguments;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:"\u52a0\u8f7d\u4e2d...",o=s.length>2&&void 0!==s[2]?s[2]:"\u64cd\u4f5c\u6210\u529f",a=s.length>3&&void 0!==s[3]?s[3]:"\u64cd\u4f5c\u5931\u8d25",i=!(s.length>4&&void 0!==s[4])||s[4],this.show(n,i),e.p=1,e.n=2,t();case 2:return c=e.v,this.showSuccess(o),e.a(2,c);case 3:throw e.p=3,u=e.v,this.showError(a),u;case 4:return e.p=4,this.hide(),e.f(4);case 5:return e.a(2)}}),e,this,[[1,3,4,5]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"isLoading",value:function(){return this.loadingCount>0}},{key:"getLoadingCount",value:function(){return this.loadingCount}},{key:"reset",value:function(){this.loadingCount=0,this.clearTimeout(),this.forceHide()}}])}(),f=new h;t["a"]=f},,,function(e,t,n){"use strict";n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return f})),n.d(t,"f",(function(){return d})),n.d(t,"a",(function(){return v})),n.d(t,"e",(function(){return g})),n.d(t,"b",(function(){return b}));var r=n(7),o=n(8),a=n(50),i=n(41),c=n(12),u={userInfo:null,hasLogin:!1,openid:null,systemInfo:null,globalData:{}},s=Object(a["create"])()(Object(i["persist"])((function(e,t){return Object(o["a"])(Object(o["a"])({},u),{},{setUserInfo:function(t){e({userInfo:t,hasLogin:!!t})},setOpenid:function(t){e({openid:t})},login:function(n,r){e({userInfo:n,hasLogin:!0,openid:r||t().openid})},logout:function(){e({userInfo:null,hasLogin:!1,openid:null}),c["a"].remove("userInfo"),c["a"].remove("token"),c["a"].remove("openid")},setSystemInfo:function(t){e({systemInfo:t})},setGlobalData:function(t,n){e((function(e){return{globalData:Object(o["a"])(Object(o["a"])({},e.globalData),{},Object(r["a"])({},t,n))}}))},getGlobalData:function(e,n){var r,o=t();return null!==(r=o.globalData[e])&&void 0!==r?r:n},removeGlobalData:function(t){e((function(e){var n=Object(o["a"])({},e.globalData);return delete n[t],{globalData:n}}))},clearGlobalData:function(){e({globalData:{}})},reset:function(){e(Object(o["a"])({},u))}})}),{name:"global-store",storage:Object(i["createJSONStorage"])((function(){return{getItem:function(e){var t=c["a"].get(e);return t?JSON.stringify(t):null},setItem:function(e,t){c["a"].set(e,JSON.parse(t))},removeItem:function(e){c["a"].remove(e)}}})),partialize:function(e){return{userInfo:e.userInfo,hasLogin:e.hasLogin,openid:e.openid,globalData:e.globalData}}})),l=function(){return s((function(e){return e.userInfo}))},h=function(){return s((function(e){return e.hasLogin}))},f=function(){return s((function(e){return e.openid}))},d=function(){return s((function(e){return e.systemInfo}))},v=function(){return s((function(e){return{login:e.login,logout:e.logout,setUserInfo:e.setUserInfo,setOpenid:e.setOpenid}}))},g=function(){return s((function(e){return{setSystemInfo:e.setSystemInfo}}))},b=function(){return s((function(e){return{setGlobalData:e.setGlobalData,getGlobalData:e.getGlobalData,removeGlobalData:e.removeGlobalData,clearGlobalData:e.clearGlobalData}}))}},function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return p}));n(8);var r=n(4),o=n(9),a=n(13),i=n(5),c=n(16),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.showLoading,n=void 0===t||t,u=e.loadingText,s=void 0===u?"\u52a0\u8f7d\u4e2d...":u,l=e.successText,h=void 0===l?"\u64cd\u4f5c\u6210\u529f":l,f=e.errorText,d=void 0===f?"\u64cd\u4f5c\u5931\u8d25":f,v=e.autoHide,g=void 0===v||v,b=e.onSuccess,p=e.onError,O=Object(i["useState"])(!1),y=Object(a["a"])(O,2),w=y[0],j=y[1],m=Object(i["useRef"])(!1),k=Object(i["useCallback"])(function(){var e=Object(o["a"])(Object(r["a"])().m((function e(t){var o,a;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:if(!m.current){e.n=1;break}return console.warn("Another async operation is in progress"),e.a(2,void 0);case 1:return e.p=1,j(!0),m.current=!0,n&&c["d"].show(s),e.n=2,t();case 2:return o=e.v,n&&h&&(c["d"].hide(),c["d"].showSuccess(h)),b&&b(),e.a(2,o);case 3:throw e.p=3,a=e.v,console.error("Async operation failed:",a),n&&d&&(c["d"].hide(),c["d"].showError(d)),p&&a instanceof Error&&p(a),a;case 4:return e.p=4,j(!1),m.current=!1,n&&g&&c["d"].hide(),e.f(4);case 5:return e.a(2)}}),e,null,[[1,3,4,5]])})));return function(t){return e.apply(this,arguments)}}(),[n,s,h,d,g,b,p]),S=Object(i["useCallback"])((function(){j(!1),m.current=!1,n&&c["d"].hide()}),[n]);return{isLoading:w,execute:k,reset:S}},s=n(6),l=n.n(s),h=n(22),f=n(17),d=n(24),v=function(){var e=Object(h["g"])(),t=Object(h["c"])(),n=Object(h["d"])(),a=Object(h["a"])(),c=a.login,s=a.logout,v=a.setUserInfo,g=a.setOpenid,b=u({loadingText:"\u767b\u5f55\u4e2d...",successText:"\u767b\u5f55\u6210\u529f",errorText:"\u767b\u5f55\u5931\u8d25"}),p=b.isLoading,O=b.execute,y=u({loadingText:"\u9000\u51fa\u4e2d...",successText:"\u5df2\u9000\u51fa",errorText:"\u9000\u51fa\u5931\u8d25"}),w=y.isLoading,j=y.execute,m=Object(i["useCallback"])(Object(o["a"])(Object(r["a"])().m((function e(){return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,O(Object(o["a"])(Object(r["a"])().m((function e(){var t;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,Object(f["d"])();case 1:t=e.v,c(t.userInfo,t.openid);case 2:return e.a(2)}}),e)}))));case 1:return e.a(2)}}),e)}))),[O,c]),k=Object(i["useCallback"])(Object(o["a"])(Object(r["a"])().m((function e(){var t,n;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.p=0,e.n=1,Object(f["f"])();case 1:t=e.v,g(t.openid),e.n=3;break;case 2:e.p=2,n=e.v,console.error("\u9759\u9ed8\u767b\u5f55\u5931\u8d25:",n);case 3:return e.a(2)}}),e,null,[[0,2]])}))),[g]),S=Object(i["useCallback"])(Object(o["a"])(Object(r["a"])().m((function e(){return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,j(Object(o["a"])(Object(r["a"])().m((function e(){return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,Object(f["e"])();case 1:s();case 2:return e.a(2)}}),e)}))));case 1:return e.a(2)}}),e)}))),[j,s]),I=Object(i["useCallback"])((function(){var e=Object(f["a"])(),t=Object(f["c"])(),n=Object(f["b"])();e&&t?(v(t),n&&g(n)):s()}),[v,g,s]),E=Object(i["useCallback"])((function(e){return t?(null===e||void 0===e||e(),!0):(T(),!1)}),[t]),T=Object(i["useCallback"])((function(){l.a.navigateTo({url:d["e"].LOGIN})}),[]),L=Object(i["useCallback"])((function(){E()&&l.a.navigateTo({url:d["e"].PROFILE})}),[E]);return{userInfo:e,hasLogin:t,openid:n,login:m,logout:S,silentLogin:k,checkAndSyncLogin:I,isLogging:p,isLoggingOut:w,requireLogin:E,navigateToLogin:T,navigateToProfile:L}},g=new Map,b=function(e){var t=e.componentName,n=e.enableLogging,a=void 0===n||n,c=e.enableReporting,u=void 0!==c&&c,s=e.reportingEndpoint,h=Object(i["useRef"])(Date.now()),f=Object(i["useRef"])(0),d=Object(i["useRef"])(0),v=Object(i["useRef"])(0),b=Object(i["useCallback"])((function(){f.current++}),[]),p=Object(i["useCallback"])((function(e){d.current++,a&&console.log("[Performance] ".concat(t,": ").concat(e))}),[t,a]),O=Object(i["useCallback"])((function(e){v.current++,a&&console.error("[Performance] ".concat(t," Error:"),e)}),[t,a]),y=Object(i["useCallback"])((function(){var e=Date.now(),n=e-h.current;return{componentName:t,loadTime:n,renderTime:f.current,userInteractions:d.current,errorCount:v.current,timestamp:e}}),[t]),w=Object(i["useCallback"])(Object(o["a"])(Object(r["a"])().m((function e(){var n,o;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:if(u&&s){e.n=1;break}return e.a(2);case 1:return n=y(),e.p=2,e.n=3,l.a.request({url:s,method:"POST",data:n});case 3:a&&console.log("[Performance] Metrics reported for ".concat(t)),e.n=5;break;case 4:e.p=4,o=e.v,console.error("[Performance] Failed to report metrics:",o);case 5:return e.a(2)}}),e,null,[[2,4]])}))),[u,s,y,t,a]);return Object(i["useEffect"])((function(){return h.current=Date.now(),a&&console.log("[Performance] ".concat(t," mounted")),function(){var e=y();g.set(t,e),a&&console.log("[Performance] ".concat(t," unmounted:"),e),w()}}),[t,a,y,w]),Object(i["useEffect"])((function(){b()})),{recordInteraction:p,recordError:O,getMetrics:y,reportMetrics:w}},p=function(e){var t=Object(i["useRef"])(Date.now()),n=b({componentName:"Page_".concat(e),enableLogging:!1,enableReporting:!0}),r=n.recordInteraction,o=n.recordError,a=n.getMetrics,c=Object(i["useCallback"])((function(){var e=Date.now()-t.current;r("page_show_".concat(e,"ms"))}),[r]),u=Object(i["useCallback"])((function(){var e=Date.now()-t.current;r("page_hide_".concat(e,"ms"))}),[r]),s=Object(i["useCallback"])((function(e){r("page_share_".concat(e))}),[r]),h=Object(i["useCallback"])((function(){r("pull_refresh")}),[r]);return Object(i["useEffect"])((function(){var e,t=null===(e=l.a.getCurrentInstance())||void 0===e?void 0:e.page;if(t){var n=t.onShow,r=t.onHide,o=t.onShareAppMessage,a=t.onShareTimeline,i=t.onPullDownRefresh;return t.onShow=function(){c(),n&&n.call(this)},t.onHide=function(){u(),r&&r.call(this)},t.onShareAppMessage=function(e){return s("friend"),o?o.call(this,e):{}},t.onShareTimeline=function(){return s("timeline"),a?a.call(this):{}},t.onPullDownRefresh=function(){h(),i&&i.call(this)},function(){t&&(t.onShow=n,t.onHide=r,t.onShareAppMessage=o,t.onShareTimeline=a,t.onPullDownRefresh=i)}}}),[c,u,s,h]),{recordInteraction:r,recordError:o,getMetrics:a,recordPageShow:c,recordPageHide:u,recordPageShare:s,recordPullRefresh:h}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return c}));var r="https://api.example.com",o=1e4,a=3,i={LOGIN:"/pages/login/index",PROFILE:"/pages/profile/index",HOME:"/pages/index/index"},c={TIMEOUT:o,MAX_RETRY:a,RETRY_DELAY:1e3,CONCURRENT_LIMIT:10}}]]);